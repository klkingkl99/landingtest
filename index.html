<!doctype html>
<html lang="ms">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mini Game</title>

  <!-- Meta Pixel Code -->
  <script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '1398817751151647');
  fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1398817751151647&ev=PageView&noscript=1"
  /></noscript>
  <!-- End Meta Pixel Code -->

  <style>
    :root{
      --text:#eef6ff;
      --muted:rgba(238,246,255,.75);
      --panel:rgba(12,18,32,.70);
      --panel2:rgba(12,18,32,.85);
      --line:rgba(255,255,255,.12);
      --gold:#f2d18b;
      --radius:18px;
      --shadow:rgba(0,0,0,.45);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--text);
      background:#050a14;
      overflow-x:hidden;
    }

    /* ËÉåÊôØ */
    .pageBg{
      position:fixed; inset:0;
      background:
        radial-gradient(900px 420px at 50% 10%, rgba(255,255,255,.10), rgba(255,255,255,0) 60%),
        linear-gradient(180deg, rgba(0,0,0,.25), rgba(0,0,0,.18) 35%, rgba(0,0,0,.55)),
        url("./bg.png") center/cover no-repeat;
      filter:brightness(1.12) saturate(1.10);
      z-index:0;
    }
    .vignette{
      position:fixed; inset:0;
      background:radial-gradient(900px 650px at 50% 40%, rgba(0,0,0,0), rgba(0,0,0,.62) 78%);
      pointer-events:none;
      z-index:0;
    }

    .wrap{
      position:relative; z-index:1;
      max-width:520px;
      margin:0 auto;
      padding:16px 14px 28px;
      display:flex;
      flex-direction:column;
      gap:12px;
      min-height:100vh;
    }

    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      padding:10px 12px;
      border-radius:var(--radius);
      background:rgba(10,14,26,.62);
      border:1px solid rgba(255,255,255,.10);
      backdrop-filter:blur(12px);
      box-shadow:0 10px 25px var(--shadow);
    }

    .brand{display:flex; gap:10px; align-items:center; font-weight:900}
    .logo{
      width:34px;height:34px;border-radius:12px;
      background:radial-gradient(circle at 30% 30%, rgba(242,209,139,.95), rgba(242,209,139,.10));
      border:1px solid rgba(242,209,139,.35);
      box-shadow:0 10px 20px rgba(0,0,0,.25);
    }
    .menu{opacity:.9;font-size:14px;color:var(--muted)}

    .card{
      border-radius:var(--radius);
      background:var(--panel);
      border:1px solid rgba(255,255,255,.10);
      backdrop-filter:blur(12px);
      box-shadow:0 10px 25px var(--shadow);
      overflow:hidden;
      position:relative;
    }

    .chat{padding:14px 14px 10px}
    .bubble{
      display:inline-block;
      max-width:92%;
      padding:10px 12px;
      border-radius:16px;
      background:rgba(255,255,255,.10);
      border:1px solid rgba(255,255,255,.10);
      margin-bottom:10px;
      line-height:1.35;
      font-size:14.5px;
    }
    .bubble.me{
      background:rgba(242,209,139,.12);
      border:1px solid rgba(242,209,139,.22);
    }

    /* game Âç°ÁâáËÉåÊôØÂè†Â±Ç */
    section.card.game{
      background:url("./bg.png") center/cover no-repeat;
    }
    section.card.game::before{
      content:"";
      position:absolute; inset:0;
      background:linear-gradient(to bottom, rgba(12,18,32,.70), rgba(12,18,32,.90));
      z-index:0;
    }
    section.card.game > *{position:relative; z-index:1;}

    .game{padding:14px; display:flex; flex-direction:column; gap:12px;}
    .headline{font-size:26px; font-weight:950; margin:6px 0 0}
    .sub{margin:6px 0 0; color:var(--muted); font-size:14px; line-height:1.4}

    .progress{
      margin-top:10px;
      display:flex;
      align-items:center;
      gap:12px;
      color:var(--muted);
      font-size:13px;
    }
    .bar{flex:1; height:8px; border-radius:999px; background:rgba(255,255,255,.12); overflow:hidden}
    .bar > i{
      display:block;
      height:100%;
      width:0%;
      background:linear-gradient(90deg, var(--gold), rgba(242,209,139,.25));
      border-radius:999px;
      transition:width .35s ease;
    }

    .choices{
      display:grid;
      grid-template-columns:repeat(3, 1fr);
      gap:10px;
      margin-top:10px;
    }
    .choice{
      padding:12px 10px;
      border-radius:16px;
      background:rgba(0,0,0,.18);
      border:1px solid rgba(255,255,255,.12);
      text-align:center;
      cursor:pointer;
      transition:transform .12s ease, border-color .12s ease, background .12s ease, box-shadow .12s ease;
      user-select:none;
    }
    .choice:hover{
      transform:translateY(-2px);
      background:rgba(255,255,255,.06);
      border-color:rgba(242,209,139,.28);
      box-shadow:0 12px 26px rgba(0,0,0,.28);
    }
    .choice.selected{
      border-color:rgba(242,209,139,.55);
      background:rgba(242,209,139,.10);
      box-shadow:0 16px 34px rgba(0,0,0,.32);
    }
    .chest-icon{
      width:54px;height:54px;
      margin:0 auto 8px;
      display:block;
      object-fit:contain;
      filter:drop-shadow(0 12px 18px rgba(0,0,0,.38));
    }
    .choice strong{display:block; font-size:13px; font-weight:900}
    .choice span{display:block; margin-top:6px; font-size:12px; color:var(--muted)}

    .cta{margin-top:10px; display:flex; gap:10px}
    .btn{
      width:100%;
      padding:14px 14px;
      border-radius:999px;
      cursor:pointer;
      border:1px solid rgba(255,255,255,.16);
      background:rgba(0,0,0,.20);
      color:var(--muted);
      font-weight:900;
    }
    .btn.primary{
      background:linear-gradient(135deg, rgba(242,209,139,.95), rgba(255,226,167,.78));
      color:#111;
      border:none;
    }
    .btn:disabled{
      opacity:.55;
      cursor:not-allowed;
      filter:saturate(.8);
    }

    .result{
      padding:14px;
      background:var(--panel2);
      border:1px solid rgba(255,255,255,.10);
      display:none;
    }
    .result h3{margin:0 0 6px; font-size:16px}
    .result p{margin:0; color:var(--muted); font-size:13.5px; line-height:1.45}

    .faq{padding:14px}
    .faqTitle{font-weight:950; margin-bottom:2px}
    details{
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.18);
      border-radius:14px;
      padding:10px 12px;
      margin-top:10px;
    }
    summary{cursor:pointer; font-weight:900; list-style:none;}
    details p{margin:8px 0 0; color:var(--muted); font-size:13.5px; line-height:1.45}

    footer{
      margin-top:auto;
      padding:12px 6px 0;
      color:rgba(238,246,255,.55);
      font-size:12px;
      text-align:center;
    }

    /* Debug */
    .debug{
      position:fixed;
      left:10px; bottom:10px;
      z-index:9999;
      font-size:12px;
      padding:8px 10px;
      border-radius:12px;
      background:rgba(0,0,0,.55);
      border:1px solid rgba(255,255,255,.14);
      color:rgba(238,246,255,.85);
      backdrop-filter: blur(10px);
    }
  </style>
</head>

<body>
  <div class="pageBg" aria-hidden="true"></div>
  <div class="vignette" aria-hidden="true"></div>

  <main class="wrap">
    <div class="topbar">
      <div class="brand"><div class="logo"></div><div>Mini Game</div></div>
      <div class="menu">Menu ‚ò∞</div>
    </div>

    <section class="card chat">
      <div class="bubble">Bossku‚Ä¶ jom try sikit. Santai je üòÑ</div>
      <div class="bubble me">Pilih satu, cuba nasib. Kalau tak best, keluar je.</div>
    </section>

    <section class="card game">
      <div class="game">
        <div>
          <div class="headline">Pilih satu, cuba nasib</div>
          <div class="sub">Tekan salah satu ‚Äúchest‚Äù bawah ni. Lepas tu kita teruskan step seterusnya.</div>

          <div class="progress">
            <span id="stepText">Step 1/3</span>
            <div class="bar"><i id="barFill"></i></div>
          </div>
        </div>

        <div class="choices" id="choices">
          <div class="choice" data-chest="A">
            <img class="chest-icon" src="./image-box.png" alt="Chest A">
            <strong>Chest A</strong><span>Cuba sini</span>
          </div>
          <div class="choice" data-chest="B">
            <img class="chest-icon" src="./image-box.png" alt="Chest B">
            <strong>Chest B</strong><span>Cuba sini</span>
          </div>
          <div class="choice" data-chest="C">
            <img class="chest-icon" src="./image-box.png" alt="Chest C">
            <strong>Chest C</strong><span>Cuba sini</span>
          </div>
        </div>

        <div class="cta">
          <button class="btn" id="btnLearn">Tengok lagi</button>
          <button class="btn primary" id="btnContinue" disabled>Cuba dulu</button>
        </div>
      </div>
    </section>

    <section class="card result" id="resultBox">
      <div class="game">
        <h3 id="resultTitle">Nice! Kau pilih Chest A.</h3>
        <p id="resultDesc">Kita teruskan step 2‚Ä¶ üòâ</p>
      </div>
    </section>

    <section class="card faq">
      <div class="faqTitle">Soalan biasa</div>
      <details><summary>Ini game apa sebenarnya?</summary><p>Ini mini interaksi untuk test minat & pengalaman. Santai je, try dulu.</p></details>
      <details><summary>Kenapa kena pilih chest?</summary><p>Sebab kita nak tengok style pilihan orang. Data ni bantu improve step seterusnya.</p></details>
      <details><summary>Data aku selamat?</summary><p>Kita cuma track klik/step asas. Tak minta info peribadi dekat sini.</p></details>
    </section>

    <footer>Privacy ¬∑ Terms ¬∑ Contact</footer>
  </main>

  <div class="debug" id="dbg">bg: checking‚Ä¶</div>

  <script>
    // ‚úÖ ‰Ω†Ë¶ÅË∑≥ËΩ¨Â∞±ÊîæÈìæÊé•Âú®ËøôÈáåÔºàÂøÖÈ°ªÊòØ http/httpsÔºâ
    const NEXT_URL = ""; // ‰æãÂ¶Ç: "https://example.com/landing"

    let step = 1;
    let picked = null;

    const stepText = document.getElementById('stepText');
    const barFill  = document.getElementById('barFill');

    const resultBox  = document.getElementById('resultBox');
    const resultTitle= document.getElementById('resultTitle');
    const resultDesc = document.getElementById('resultDesc');

    const btnContinue = document.getElementById('btnContinue');

    function safeFbq(name, data){
      try { if (window.fbq) fbq('trackCustom', name, data || {}); } catch(e){}
    }

    function setStep(n){
      step = n;
      stepText.textContent = `Step ${step}/3`;
      barFill.style.width = (step/3*100) + '%';
    }
    setStep(1);

    document.getElementById('choices').addEventListener('click', (e)=>{
      const box = e.target.closest('.choice');
      if(!box) return;

      document.querySelectorAll('.choice').forEach(el=>el.classList.remove('selected'));
      box.classList.add('selected');

      picked = box.dataset.chest;
      btnContinue.disabled = false;

      resultBox.style.display = 'block';
      resultTitle.textContent = `Nice! Kau pilih Chest ${picked}.`;
      resultDesc.textContent  = `Kita teruskan step 2‚Ä¶ üòâ`;

      safeFbq('ChestSelect', { chest: picked, step });
      setStep(2);
      safeFbq('Step2_View', { chest: picked });

      resultBox.scrollIntoView({behavior:'smooth', block:'center'});
    });

    document.getElementById('btnLearn').addEventListener('click', ()=>{
      safeFbq('LearnMore_Click', { step, chest: picked || 'NA' });
      document.querySelector('details')?.scrollIntoView({behavior:'smooth', block:'center'});
    });

    document.getElementById('btnContinue').addEventListener('click', ()=>{
      // ‚úÖ Âº∫Âà∂ÂÖàÈÄâ chestÔºåÈÅøÂÖçËØØËß¶
      if(!picked){
        alert("Pilih satu chest dulu ya üòÑ");
        return;
      }

      safeFbq('Continue_Click', { step, chest: picked });

      setStep(3);
      safeFbq('Step3_View', { chest: picked });

      if(NEXT_URL && NEXT_URL.startsWith('http')){
        safeFbq('NextPage_Go', { to: NEXT_URL });
        window.location.href = NEXT_URL;
      }else{
        alert("Done! (Kalau nak redirect, letak link dekat NEXT_URL)");
      }
    });

    // ‚úÖ DebugÔºöÊ£ÄÊü•ËÉåÊôØÂõæÊòØÂê¶ÁúüÁöÑËÉΩÂä†ËΩΩ
    const dbg = document.getElementById('dbg');
    const img = new Image();
    img.onload  = () => dbg.textContent = "bg: loaded ‚úÖ (bg.png)";
    img.onerror = () => dbg.textContent = "bg: failed ‚ùå (nama/path salah)";
    img.src = "./bg.png?" + Date.now();
  </script>
</body>
</html>
